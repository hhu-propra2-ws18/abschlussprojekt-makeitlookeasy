testlogger {
    theme 'mocha-parallel'
}

reportCoverage {
    group = "verification"
}

spotbugs {
    toolVersion = '3.1.11'
    ignoreFailures = false
    effort = "max"
    reportLevel = "high"
    sourceSets = [sourceSets.main]
}

checkstyle {
    toolVersion = "8.18"
    sourceSets = [sourceSets.main]
    configFile = file("./config/checkstyle/checkstyle-google.xml")
}

tasks.withType(Checkstyle) {
    group = "verification"
    reports {
        xml.enabled = false
        html.enabled = true
    }
}

tasks.withType(Pmd) {
    group = "verification"
}

pmd {
    toolVersion = "6.12.0"
    consoleOutput = true
    ignoreFailures = true
    ruleSets = []
    ruleSetConfig = resources.text.fromFile("./config/pmd/ruleset.xml")
    sourceSets = [sourceSets.main]
}

jacocoTestReport {
    group = "verification"
    reports {
        xml.enabled true
        html.enabled true
        csv.enabled false
    }
}

jacoco {
    toolVersion "0.8.3"
}

consoleReporter {
    junit {
        enabled true
        reportOnFailure true
        summaryEnabled true
        stdoutEnabled true
        stderrEnabled true
        stacktraceEnabled true
        colorEnabled true
        partialSourceInsertionEnabled true
    }

    jacoco {
        enabled true
        onlyWhenCoverageTaskExecuted false
        reportAfterBuildFinished true
        failIfLessThanThresholdError false
        autoconfigureCoverageConfig true
        coverageTaskName 'jacocoTestReport'
        reportFile
        thresholdFine 90
        thresholdWarning 70
        thresholdError 0
        brokenCoverageErrorMessage "Coverage has fallen below the threshold in some projects."
        colorEnabled true
    }
}

buildtimetracker {
    reporters {
        csv {
            output "build/times.csv"
            append true
            header false
        }

        summary {
            ordered false
            threshold 50
            barstyle "unicode"
        }

        csvSummary {
            csv "build/times.csv"
        }
    }
}
